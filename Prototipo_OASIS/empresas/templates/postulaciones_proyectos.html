{% extends "base.html" %}

{% block title %}Postulaciones - {{ proyecto.nombre }}{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-center mb-4">Postulaciones: {{ proyecto.nombre }}</h2>

    <!-- üßë‚Äçüéì Postulaciones de Aprendices -->
    <h4 class="mb-3">üë®‚Äçüéì Postulaciones de Aprendices</h4>
    {% if postulaciones %}
        <div class="list-group mb-4">
            {% for postulacion in postulaciones %}
                <div class="list-group-item d-flex justify-content-between align-items-center">
                    <div>
                        <strong>{{ postulacion.aprendiz.usuario.first_name }} {{ postulacion.aprendiz.usuario.last_name }}</strong>
                        ({{ postulacion.aprendiz.usuario.username }}) -
                        Estado:
                        <span class="
                            {% if postulacion.estado == 'ACEPTADA' %}text-success
                            {% elif postulacion.estado == 'RECHAZADA' %}text-danger
                            {% else %}text-warning{% endif %}
                        ">
                            {{ postulacion.estado }}
                        </span>
                    </div>
                    <div>
                        {% if postulacion.estado == "PENDIENTE" %}
                            <a href="{% url 'empresas:gestionar_postulacion' postulacion.id 'aceptar' %}" class="btn btn-success btn-sm">Aceptar</a>
                            <a href="{% url 'empresas:gestionar_postulacion' postulacion.id 'rechazar' %}" class="btn btn-danger btn-sm">Rechazar</a>
                        {% else %}
                            <span class="text-muted">No disponible</span>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="text-muted">No hay postulaciones de aprendices para este proyecto.</p>
    {% endif %}

    <hr class="my-4">

    <!-- üë®‚Äçüè´ Postulaciones de Instructores -->
    <h4 class="mb-3">üë®‚Äçüè´ Postulaciones de Instructores</h4>
    {% if proyecto.postulaciones_instructores.all %}
        <div class="list-group">
            {% for postulacion in proyecto.postulaciones_instructores.all %}
                <div class="list-group-item d-flex justify-content-between align-items-center">
                    <div>
                        <strong>{{ postulacion.instructor.usuario.first_name }} {{ postulacion.instructor.usuario.last_name }}</strong>
                        ({{ postulacion.instructor.usuario.username }}) -
                        Estado:
                        <span class="
                            {% if postulacion.estado == 'ACEPTADA' %}text-success
                            {% elif postulacion.estado == 'RECHAZADA' %}text-danger
                            {% else %}text-warning{% endif %}
                        ">
                            {{ postulacion.estado }}
                        </span>
                    </div>
                    <div>
                        {% if postulacion.estado == "PENDIENTE" %}
                            <a href="{% url 'empresas:gestionar_postulacion_instructor' postulacion.id 'aceptar' %}" class="btn btn-success btn-sm">Aceptar</a>
                            <a href="{% url 'empresas:gestionar_postulacion_instructor' postulacion.id 'rechazar' %}" class="btn btn-danger btn-sm">Rechazar</a>
                        {% else %}
                            <span class="text-muted">No disponible</span>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <p class="text-muted">No hay postulaciones de instructores para este proyecto.</p>
    {% endif %}

    <div class="text-center mt-4">
        <a href="{% url 'empresas:dashboard_empresa' %}" class="btn btn-secondary">Volver al Dashboard</a>
    </div>
</div>
{% endblock %}
